## create df from force feature response 


# set lib path 
.libPaths("S:/BrandSat/02_Code/R/library_3")

install.packages("dplyr")
install.packages("raster")

library(dplyr)
library(ggplot2)
library(scales)
library(gridExtra)
library(reshape2)
library(formattable)
library(maptools)
library(sp)
library(rgdal)
library(raster)
library(sf)
library(rgeos)
library(randomForest)
library(caret)
library(matrixStats)
library(fortify)
library(mapac)
library(e1071)
library(gt)


data.path <- 'A:/04_Sampling/2021-02-05_S2_new_interpolation/txt/'
setwd(data.path)

# Force Features
pre           <- "txt_two_years_"
features      <- read.table(paste0("features.csv"), sep = " "   ,dec = "." )
int                    <- read.table(paste0("response.csv"), sep = " "   , dec = ".")
coo                    <- read.table(paste0("coordinates.csv"), sep = " ", dec = ".")

## for checking, load smp points 
# smp_points <- read.table("A:/04_Sampling/00_SamplingPoints/2020-11-05_rerevisited/force_input_smp_rerevisited.csv") 
# int_fet <- read.table("A:/04_Sampling/2020-11-20_Sampling_10m_S2_rerevisited/features/features.csv", sep = ";", dec = ".")
# unique(int)


int_tt <- read_int_tt(int, return = "int_redifined")

meters <- c(10,20)

txt_names  <- list("ERO",
                "DIL",
                "CLS",
                "OPN",
                "GRD",
                "BHT",
                "THT")


Band_names_2018_2019 <- c( #'BLU',
                 'GRN',
                 'RED',
                 'RE1',
                 'RE2',
                 #'RE3',
                 'NIR',
                 'SW1',
                 'SW2'#,
                 #'NDV'
                )

time_steps <- c("38_Spring","55_Summer")
date     <- c("20180404","20180628")

#--------------------------------------------------------------------------------

header_list <- list()
lo = 1

for (meter in meters){ #1
  
  print(meter)

  for(txt in txt_names){
  
    print(txt)
    for (band in Band_names_2018_2019 ){
    
      print(band) 
      k = 1
    
      for (time_step in time_steps){
          dat   <- date[k]
      
          head <- paste("txt",meter,"meters",txt,band,"step",time_step,dat, sep = "_")
          header_list <- append(header_list,head )
          k = k + 1
    }
  }
}
}


colnames(coo) <- c("coo_x", "coo_y")

colnames(features) <- header_list
df <- as.data.frame(cbind(coo, int_tt,features))
df_2 <- df
df_2 <- na.omit(df_2)
head(df_2)
list_list <- append(c("coo_x", "coo_y","int_split","TreeSpecies","int","int_redifined","int_testing","int_paper"), header_list)
colnames(df_2) <- list_list



## write 
df_3 <- cbind(df_2[,1:8], df_2[, grepl("Summer", colnames(df_2))])
write.table(df_3, "P:/workspace/treespecies/_review/data/df_txt_summer_20m.csv", sep = ";", col.names = TRUE, row.names = FALSE)


#################################################################################

#### FRIEDHOF



library(stringr)
dada <- "32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159"
nr_1 <- str_split(dada, pattern =" ")
length(nr_1[[1]])
dudu <- "1 3 5 7 9 11 13"
#--> 118 bands --> 826 
lolo <- "564 581 610 628 641 649 652 651 650 648 647 642 635 617 601 586 572 561 555 550 541 532 527 525 523 526 525 523 516 508 498 492 489 491 493 498 501 511 521 534 539 541 537 533 520 507 489 468 437 417 405 395 374 355 344 570 587 597 609 621 632 641 647 647 647 642 631 619 605 587 568 553 535 516 501 495 488 482 477 473 467 459 453 449 448 448 446 444 447 448 453 458 462 466 466 464 460 454 439 415 397 377 351 329 317 308 299 289 279 272 714 733 761 778 794 798 792 776 754 713 651 577 513 460 424 397 374 347 333 318 304 284 272 260 252 250 251 253 252 252 253 255 259 273 287 301 316 347 380 412 444 494 540 582 609 626 618 606 576 545 525 503 464 428 405 739 767 788 808 819 830 835 830 814 795 763 718 653 574 494 425 382 339 299 280 269 255 245 243 236 225 212 209 202 202 207 212 219 225 230 234 239 243 245 248 251 254 260 270 282 291 304 327 341 345 347 339 327 311 297 933 957 994 1013 1029 1041 1053 1059 1068 1077 1093 1101 1106 1095 1071 1041 1007 969 957 942 925 899 886 878 870 867 864 860 851 841 834 829 827 835 846 860 872 897 922 949 970 1010 1041 1069 1073 1060 1024 983 913 865 833 806 760 725 706 930 964 988 1014 1029 1043 1052 1060 1064 1068 1065 1058 1055 1051 1039 1018 994 962 920 884 867 850 838 825 822 815 803 789 782 777 772 759 747 747 748 760 773 789 804 809 811 808 800 779 744 718 692 657 625 608 594 585 568 552 540 1329 1369 1407 1442 1456 1483 1520 1575 1638 1750 1905 2116 2305 2466 2595 2702 2787 2879 2947 3018 3084 3152 3214 3280 3321 3348 3335 3309 3267 3207 3143 3104 3062 3007 2956 2917 2867 2782 2719 2665 2588 2476 
2375 2276 2154 2031 1930 1823 1666 1577 1517 1477 1400 1358 1335 1353 1379 1398 1433 1462 1484 1506 1546 1590 1639 1716 1826 1996 2203 2411 2591 2701 2811 2909 2945 2962 2987 3002 2983 2985 2989 3001 2976 2971 2933 2873 2773 2669 2628 2610 2628 2647 2670 2692 2678 2643 2604 2535 2405 2211 2049 1865 1613 1413 1318 1241 1208 1168 1136 1121 1820 1865 1906 1943 1962 1997 2050 2124 2207 2339 2521 2767 2993 3196 3371 3521 3649 3782 3890 3995 4103 4212 4311 4407 4472 4515 4506 4479 4433 4360 4276 4224 4161 4077 3995 3924 3843 3714 3632 3561 3468 3336 3228 3119 2983 2841 2720 2586 2381 2251 2162 2099 1982 1913 1874 1861 1899 1928 1974 2007 2033 2057
2099 2146 2196 2283 2410 2602 2837 3083 3305 3453 3606 3753 3821 3849 3882 3898 3876 3873 3870 3880 3849 3839 3787 3709 3578 3443 3390 3371 3399 3426 3448 3468 3438 3381 3329 3242 3095 2873 2683 2466 2175 1940 1830 1738 1699 1644 1603 1582 1665 1719 1772 1810 1847 1873 1905 1926 1938 1930 1888 1827 1777 1737 1711 1691 1675 1660 1662 1657 1657 1653 1657 1658 1661 1664 1657 1650 1637 1622 1603 1589 1573 1556 1539 1524 1508 1490 1488 1488 1484 1478 1477 1474 1459 1451 1433 1410 1356 1303 1260 1220 1153 1101 1070 1845 1920 1976 2031 2062 2090 2112 2118 2108 2094 2065 2023 1971 1909 1855 1802 1771 1739 1712 1695 1682 1665 1650 1635 1617 1592 1570 1547 1526 1501 1476 1428 1383 1371 1370 1387 1403 1417 1430 1424 1408 1398 1381 1347 1292 1247 1200 1134 1079 1052 1029 1014 992 974 961 1059 1096 1134 1159 1187 1201 1217 1222 1220 1191 1133 1047 969 900 849 808 773 740 724 703 685 663 648 632 621 616 610 607 603 605 604 603 603 602 600 597 593 596 603 611 617 625 633 639 642 654 661 665 659 644 629 613 589 570 560 1200 1254 1290 1319 1337 1354 1367 1363 1345 1323 1280 1224 1149 1059 974 894 846 795 750 726 711 692 677 668 654 632 611 597 581 568 559 542 527 523 523 529 535 542 550 551 550 550 550 548 542 538 536 532 528 525 523 519 514 508 504 607 723 999 1482 1994 1766 1090 652 792 1053 1520 2050 1905 1217 652 792 1053 1520 2050 1905 1217 613 723 999 1482 1994 1774 1101 45 69 54 38 56 139 127 0 0 0 0 0 0 0 39 69 54 38 56 131 116
"
lplp <-  str_split(lolo, pattern =" ")
length(lplp[[1]])

#-- model wurde mit 819 trained
#-- in predict sind aber 826 


# rausfinden welche bänder in train sind 